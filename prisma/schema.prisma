generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider          = "mysql"
  url               = env("DATABASE_URL")
  shadowDatabaseUrl = env("SHADOW_DATABASE_URL")
  relationMode      = "prisma"
}

model User {
  id              String           @id @default(uuid())
  createdAt       DateTime         @default(now())
  username        String           @unique
  password        String
  roleId          String
  roles           Role             @relation(fields: [roleId], references: [id])
  characterSheets CharacterSheet[]

  @@index([roleId])
}

model Role {
  id        String   @id @default(uuid())
  createdAt DateTime @default(now())
  roleName  String
  users     User[]
}

model CharacterSheet {
  id               String               @id @default(uuid())
  createdAt        DateTime             @default(now())
  userId           String
  chName           String
  chLevel          Int
  user             User                 @relation(fields: [userId], references: [id], onDelete: Cascade)
  chAttributes     CharacterAttribute[]
  AttributesValues AttributesValue[]

  @@index([userId])
}

model CharacterAttribute {
  id             String           @id @default(uuid())
  createdAt      DateTime         @default(now())
  chSheetId      String
  chSheets       CharacterSheet   @relation(fields: [chSheetId], references: [id], onDelete: Cascade)
  AttributesName AttributesName[]

  @@index([chSheetId])
}

model AttributesName {
  id                 String             @id @default(uuid())
  name               String
  chAttrId           String
  AttributesValues   AttributesValue[]
  createdAt          DateTime           @default(now())
  CharacterAttribute CharacterAttribute @relation(fields: [chAttrId], references: [id])

  @@index([chAttrId])
}

model AttributesValue {
  id         String         @id @default(uuid())
  chSheetId  String
  attrNameId String
  value      String
  attrName   AttributesName @relation(fields: [attrNameId], references: [id], onDelete: Cascade)
  chSheet    CharacterSheet @relation(fields: [chSheetId], references: [id], onDelete: Cascade)
  createdAt  DateTime       @default(now())

  @@index([attrNameId])
  @@index([chSheetId])
}
