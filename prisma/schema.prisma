// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider          = "mysql"
  url               = env("DATABASE_URL")
  shadowDatabaseUrl = env("SHADOW_DATABASE_URL")
  relationMode      = "prisma"
}

model User {
  id              String            @id
  createdAt       DateTime          @default(now())
  username        String            @unique
  password        String
  roleId          String
  roles           Role              @relation(fields: [roleId], references: [id])
  characterSheets CharacterSheets[]

  @@index([roleId])
}

model Role {
  id        String   @id
  createdAt DateTime @default(now())
  roleName  String
  roleLevel Int
  users     User[]
}

model CharacterSheets {
  id           String                @id
  createdAt    DateTime              @default(now())
  userId       String
  user         User                  @relation(fields: [userId], references: [id], onDelete: Cascade)
  chName       String
  chAttributes CharacterAttributes[]

  @@index([userId])
}

model CharacterAttributes {
  id         String          @id
  createdAt  DateTime        @default(now())
  chSheetId  String
  chSheets   CharacterSheets @relation(fields: [chSheetId], references: [id], onDelete: Cascade)
  attrNameId String
  attrName   AttributesName  @relation(fields: [attrNameId], references: [id], onDelete: Cascade)

  @@index([chSheetId])
  @@index([attrNameId])
}

model AttributesName {
  id               String                @id
  createdAt        DateTime              @default(now())
  chAttributes     CharacterAttributes[]
  AttributesValues AttributesValues[]
  name             String
}

model AttributesValues {
  id         String         @id
  createdAt  DateTime       @default(now())
  attrNameId String
  attrName   AttributesName @relation(fields: [attrNameId], references: [id], onDelete: Cascade)
  value      String

  @@index([attrNameId])
}
